---
layout: post
title: Highlight PowerShell in red when running as Administrator
---

If you have the <a href="http://pscx.codeplex.com/">PowerShell Community Extensions</a> installed, you can load your profile for editing by running <i>notepad $profile</i> or <i>ep</i>.<br /><br />Paste the code from <a href="http://www.interact-sw.co.uk/iangblog/2007/02/09/pshdetectelevation">this blog</a> into your profile:<br /><pre class="brush: ps">& {<br />    $wid=[System.Security.Principal.WindowsIdentity]::GetCurrent()<br />    $prp=new-object System.Security.Principal.WindowsPrincipal($wid)<br />    $adm=[System.Security.Principal.WindowsBuiltInRole]::Administrator<br />    $IsAdmin=$prp.IsInRole($adm)<br />    if ($IsAdmin)<br />    {<br />        (get-host).UI.RawUI.Backgroundcolor="DarkRed"<br />        clear-host<br />    }<br />}<br /></pre><br />If you are running all users as standard users (which you should really be doing, <a href="http://technet.microsoft.com/en-us/magazine/2009.07.uac.aspx#id0560040">see why here</a>), there is no need to use this script. Simply put the following code into the Administrator profile:<br /><pre class="brush: ps">(get-host).UI.RawUI.Backgroundcolor="DarkRed"<br />clear-host<br /></pre>
