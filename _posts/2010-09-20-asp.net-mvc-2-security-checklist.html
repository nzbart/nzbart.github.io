---
layout: post
title: ASP.NET MVC 2 Security Checklist
---

Combining: http://stackoverflow.com/questions/2183890/asp-net-mvc-security-checklist<br /><br />http://pentonizer.com/general-programming/aspnet-poet-vulnerability-what-else-can-i-do/<br />http://www.devx.com/dotnet/Article/32493/1954<br /><br />Security Blackbox Checklist<br />•Submit incorrect/malicious data (examples here?) to make sure that input is validated for type, length, format and range by javascript.<br />•Turn off client-side validation and repeat the step above, to make sure that <br />•you don't only check with javascript but validate on the server side as well<br />•input is validated on the server for type, length, format, and range<br />•free form input is sanitized<br />•output that includes input is encoded with HtmlEncode and UrlEncode<br />•Insert extremely large amount of data in the query string as per http://www.example.com/foo?bar=HugeAmountOfData to make sure you constrain inputs and do boundary checks.<br />•Visit a POST action via GET, to make sure that "form submit" actions are restricted to be POST-only.<br />•If applicable, upload a file of incorrect size/format (huge file, empty file, executable with renamed extension, etc) to make sure uploads are handled gracefully.<br />•(how to check from UI?) ensure that absolute URLs are used for navigation.<br />•Access the URL as a user without correct permissions, to make sure permissions are explicitly tested via action/controller attributes.<br />•Access the URL providing non-existing details (like non-existing product ids, items you don't have access to, etc) to make sure a correct error (404 or 403 etc) is returned.<br />•Access the sensitive page via HTTP, to make sure it's available via HTTPS only.<br />Security Whitebox Checklist<br />Web tier.<br /><br />•In debug mode, break the code so that it throws an exception, to make sure it fails securely. Make sure you catch exceptions and log detailed messages but do not leak information to the client.<br />•If applicable, make sure MVC actions, are restricted on POST/GET only, particular user role, anything else?.<br />•Make sure POST actions are accompanied with [ValidateAntiForgeryToken] attribute to prevent Cross-Site Request Forgery attacks. <br />•Make sure Response.Write (either directly or indirectly) is never used to display user input.<br />•Make sure sensitive data is not passed in query strings or form fields.<br />•Make sure your security decisions do not rely on HTTP headers info.<br />Service tier.<br /><br />•In debug mode, break the code so that it throws an exception, to make sure it fails securely. Make sure you catch exceptions and log detailed messages but do not leak information to the client.<br />•Ensure that if updating anything in the database you operate within a transaction.<br />Database tier.<br /><br />•Ensure that retrieval stored procs don't use SELECT * but always specify the list of columns explicitly.<br />•Ensure that update/delete stored procs operate within a transaction (via @@TRANCOUNT, etc) and explicitly commit/rollback it.<br /><br />To add to the list:<br /><br />Black: DoS attacks - employ tinyget or similar to simulate DoS attacks, see what your app does.<br /><br />Black: Canonicalization attacks. Mentioned a bit, may be special focus can be on a directory traversal attack in case of downloads.<br /><br />White: Usage of cookies for the sensitive info? See cookies are not used for sensitive data and are not persisted locally over the intented interval. Black: Sniff in the temp IE/XYZ folder for cookies.<br /><br />Black: Again, use scripted tinyget or try manually to see if brute force password guess would work or if you app has smart delays/denials for a password guess attacks.<br /><br />Black: Do any of the attacks and see if admin is notified automatically of the attack or it is only the attacker who knows about it.<br /><br />"Make sure your security decisions do not rely on HTTP headers info" - http headers are used for ntml/kerberos authentication? May be just don't use them stupidly, don't invent or rely on referer, etc?<br /><br />General: Employ a commercial black/white-box security scanner, can be expensive but can be hard to do security regression tests otherwise.<br /><br /><br />•User credentials are validated on each request, either GET or POST or other, to confirm the user authentication<br /><br />•Check user authorization (after checking authentication) for each sensitive operation<br /><br />•Watch out output caching, especially if you implement your own membership system<br /><br /><br />Sticking mostly to MVC-specific stuff:<br /><br />•In ASP.NET 4, understand <%: and MvcHtmlString. •Use HTML helpers when possible instead of raw HTML as it increases the chances you'll remember to encode (the helpers do it for you) •Analyze all uses of JsonRequestBehavior.AllowGet to ensure it cannot return an array. •Don't reinvent anything security-related. Use proven, maintained, off-the-shelf implementations. •Don't leak security information in robots.txt  Make sure you don't blindly bind form data to your model by always using TryUpdateModel<t> over TryUpdateModel.<br /><br /><br />See also http://codevanced.net/post/ASPNET-MVC-security-checklist.aspx<br /><br />Include cookie encryption and httpOnly<br />Include X-Content-Type-Options: nosniff<br />Use valid SSL certificates.
