---
layout: post
title: WiX 3.5 in Visual Studio 2010 undefined preprocessor variable when solution
  folders used
---

I ran into a problem with the WiX 3.5 installer in Visual Studio 2010 when trying to add a reference to a project in a solution folder. The folder structure looked like this:<br /><br /><ul><li>Client</li><ul><li>WiXProject</li><ul><li>References</li><ul><li><b>Common _Common\Common_</b></li></ul></ul></ul><li>Common</li><ul><li>Common</li></ul></ul>The installer built fine when I set <i>Harvest</i> to <i>True</i>, but, since I wanted more control over the installer, I wanted to manually edit the <i>wxs</i> file like this:<br /><br /><pre class="brush:xml">&lt;file diskid="1" id="Common" name="$(var.Common.TargetFileName)" source="$(var.Common.TargetPath)"&gt;<br /></pre><br />Unfortunately, Votive (the WiX integration with Visual Studio) does not seem to correctly handle references to projects in solution folders. The workaround I used was to unload the WiX project and edit the line as highlighted:<br /><br /><pre class="brush:xml;highlight:[2]">    <ProjectReference Include="..\Common\Common.csproj"><br />      <Name>Common _Common\Common_</Name><br />      <Project>{89f6f5f2-5aeb-4501-9f4f-9073d7dedd4c}</Project><br />      <Private>True</Private><br />      <DoNotHarvest>True</DoNotHarvest><br />      <RefProjectOutputGroups>Binaries;Content;Satellites</RefProjectOutputGroups><br />      <RefTargetDir>INSTALLLOCATION</RefTargetDir><br />    </ProjectReference><br /></pre><br /><pre class="brush:xml;highlight:[2]">    <ProjectReference Include="..\Common\Common.csproj"><br />      <Name>Common</Name><br />      <Project>{89f6f5f2-5aeb-4501-9f4f-9073d7dedd4c}</Project><br />      <Private>True</Private><br />      <DoNotHarvest>True</DoNotHarvest><br />      <RefProjectOutputGroups>Binaries;Content;Satellites</RefProjectOutputGroups><br />      <RefTargetDir>INSTALLLOCATION</RefTargetDir><br />    </ProjectReference><br /></pre><br />When I reloaded the project, my <i>wxs</i> file worked as originally configured because the variable <code>var.Common.TargetFileName</code> was now defined.
