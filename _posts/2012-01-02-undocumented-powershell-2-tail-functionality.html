---
layout: post
title: Undocumented PowerShell 2 Tail Functionality
---

One feature that I have often thought was missing from PowerShell is the equivalent to the *nix <a href="http://www.gnu.org/software/coreutils/manual/html_node/tail-invocation.html">tail</a> functionality, which will display lines as they are added to a log file. I have used the <a href="http://pscx.codeplex.com/">PowerShell Community Extensions</a>&nbsp;(PSCX) Get-FileTail cmdlet, but that can be frustrating because it is not available on all the computers I use, so I wanted to find a built-in equivalent.<br /><br />It turns out that there is an undocumented built-in tail function. Use the Get-Content (alias = gc) cmdlet with the undocumented -Wait parameter. Apparently, it has performance issues with large files, so you may still need to carry a copy of PSCX around with you on a USB stick, but this should suffice for most scenarios.<br /><br />Below is the documentation for Get-Content for PowerShell 2.0, with no mention of the -Wait parameter.<br /><br /><br /><pre class="brush:plain"><br />NAME<br />    Get-Content<br />    <br />SYNOPSIS<br />    Gets the content of the item at the specified location.<br />    <br />    <br />SYNTAX<br />    Get-Content [-LiteralPath] <string[]> [-Credential <PSCredential>] [-Exclude <string[]>] [-Filter <string>] [-Force<br />    ] [-Include <string[]>] [-ReadCount <Int64>] [-TotalCount <Int64>] [-UseTransaction] [<CommonParameters>]<br />    <br />    Get-Content [-Path] <string[]> [-Credential <PSCredential>] [-Exclude <string[]>] [-Filter <string>] [-Force] [-Inc<br />    lude <string[]>] [-ReadCount <Int64>] [-TotalCount <Int64>] [-UseTransaction] [<CommonParameters>]<br />    <br />    <br />DESCRIPTION<br />    The Get-Content cmdlet gets the content of the item at the location specified by the path, such as the text in a fi<br />    le. It reads the content one line at a time and returns an object for each line.<br />    <br /><br />PARAMETERS<br />    -Credential <PSCredential><br />        Specifies a user account that has permission to perform this action. The default is the current user. <br />        <br />        Type a user name, such as "User01" or "Domain01\User01", or enter a PSCredential object, such as one generated <br />        by the Get-Credential cmdlet. If you type a user name, you will be prompted for a password.<br />        <br />        This parameter is not supported by any providers that are installed with Windows PowerShell.<br />        <br />    -Exclude <string[]><br />        Omits the specified items. The value of this parameter qualifies the Path parameter. Enter a path element or pa<br />        ttern, such as "*.txt". Wildcards are permitted.<br />        <br />    -Filter <string><br />        Specifies a filter in the provider's format or language. The value of this parameter qualifies the Path paramet<br />        er. The syntax of the filter, including the use of wildcards, depends on the provider. Filters are more efficie<br />        nt than other parameters, because the provider applies them when retrieving the objects, rather than having Win<br />        dows PowerShell filter the objects after they are retrieved.<br />        <br />    -Force [<SwitchParameter>]<br />        Overrides restrictions that prevent the command from succeeding, just so the changes do not compromise security<br />        . For example, Force will override the read-only attribute or create directories to complete a file path, but i<br />        t will not attempt to change file permissions.<br />        <br />    -Include <string[]><br />        Retrieves only the specified items. The value of this parameter qualifies the Path parameter. Enter a path elem<br />        ent or pattern, such as "*.txt". Wildcards are permitted.<br />        <br />    -LiteralPath <string[]><br />        Specifies the path to an item. Unlike Path, the value of LiteralPath is used exactly as it is typed. No charact<br />        ers are interpreted as wildcards. If the path includes escape characters, enclose it in single quotation marks.<br />         Single quotation marks tell Windows PowerShell not to interpret any characters as escape sequences.<br />        <br />    -Path <string[]><br />        Specifies the path to an item. Get-Content retrieves the content of the item. Wildcards are permitted. The para<br />        meter name ("Path" or "FilePath") is optional.<br />        <br />    -ReadCount <Int64><br />        Specifies how many lines of content are sent through the pipeline at a time. The default value is 1. A value of<br />         0 (zero) sends all of the content at one time. <br />        <br />        This parameter does not change the content displayed, but it does affect the time it takes to display the conte<br />        nt. As the value of ReadCount increases, the time it takes to return the first line increases, but the total ti<br />        me for the operation decreases. This can make a perceptible difference in very large items.<br />        <br />    -TotalCount <Int64><br />        Specifies how many lines of content are retrieved. The default is -1 (all lines).<br />        <br />    -UseTransaction [<SwitchParameter>]<br />        Includes the command in the active transaction. This parameter is valid only when a transaction is in progress.<br />         For more information, see about_Transactions.<br />        <br />    <CommonParameters><br />        This cmdlet supports the common parameters: Verbose, Debug,<br />        ErrorAction, ErrorVariable, WarningAction, WarningVariable,<br />        OutBuffer and OutVariable. For more information, type,<br />        "get-help about_commonparameters".<br />    <br />    -------------------------- EXAMPLE 1 --------------------------<br />    <br />    C:\PS>get-content -Path C:\Chapters\chapter1.txt<br />    <br />    Description<br />    -----------<br />    This command displays the content of the Chapter1.txt file on the console. It uses the Path parameter to specify th<br />    e name of the item. Get-Content actually passes the content down the pipeline, but because there are no other pipel<br />    ine elements, the content is formatted and displayed on the console.<br />    <br />    <br />    <br />    <br />    -------------------------- EXAMPLE 2 --------------------------<br />    <br />    C:\PS>get-content c:\Logs\Log060912.txt -totalcount 50 | set-content sample.txt<br />    <br />    Description<br />    -----------<br />    This command gets the first 50 lines of the Log060912.txt file and stores them in the sample.txt file. The command <br />    uses the Get-Content cmdlet to get the text in the file. (The name of Path parameter, which is optional, is omitted<br />    .) The TotalCount parameter limits the retrieval to the first 50 lines. The pipeline operator (|) sends the result <br />    to Set-Content, which places it in the sample.txt file.<br />    <br />    <br />    <br />    <br />    -------------------------- EXAMPLE 3 --------------------------<br />    <br />    C:\PS>(get-content cmdlets.txt -totalcount 5)[-1]<br />    <br />    Description<br />    -----------<br />    This command gets the fifth line of the Cmdlets.txt text file. It uses the TotalCount parameter to get the first fi<br />    ve lines and then uses array notation to get the last line (indicated by "-1") of the resulting set.<br />    <br />    <br />    <br />    <br />REMARKS<br />    To see the examples, type: "get-help Get-Content -examples".<br />    For more information, type: "get-help Get-Content -detailed".<br />    For technical information, type: "get-help Get-Content -full".<br /></pre>
