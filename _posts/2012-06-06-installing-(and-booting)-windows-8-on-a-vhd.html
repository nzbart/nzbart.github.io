---
layout: post
title: Installing (and booting) Windows 8 on a VHD
---

Windows 8 (and Server 2012) greatly simplifies installing Windows 7 / Windows Server 2008 R2 / Windows 8 / Windows Server 2012 to a VHD or VHDX for booting without having to mess around with partitions.  <a href="http://gallery.technet.microsoft.com/scriptcenter/Convert-WindowsImageps1-0fe23a8f">Convert-WindowsImage.ps1</a> is a fantastic tool that you can run from Windows 8 or Server 2012 to install a new operating system without rebooting your machine.  To install Windows 8 Release Preview on a VHDX, I did the following: <br /><br /><ol><li>Download and unblock the PowerShell script <a href="http://gallery.technet.microsoft.com/scriptcenter/Convert-WindowsImageps1-0fe23a8f">Convert-WindowsImage.ps1</a>. I couldn't find the unblock checkbox on the file properties dialog, so I used the Sysinternals streams.exe utility to remove the block: <pre>streams -d Convert-WindowsImage.ps1</pre></li><li>I then mounted the <a href="http://windows.microsoft.com/en-US/windows-8/download">Windows 8&nbsp;ISO image</a> by double clicking on it in Explorer, taking advantage of the <a href="http://blogs.msdn.com/b/b8/archive/2011/08/30/accessing-data-in-iso-and-vhd-files.aspx">belated&nbsp;ISO mounting feature</a>. In my case, it mounted to E:.</li><li>Next, I ran <a href="http://gallery.technet.microsoft.com/scriptcenter/Convert-WindowsImageps1-0fe23a8f">Convert-WindowsImage.ps1</a>&nbsp;with the following command line: <pre>.\Convert-WindowsImage.ps1 -SourcePath E:\sources\install.wim -VHDFormat VHD -SizeBytes 50GB -VHDPath Windows8RP.vhd -VHDType Fixed -Edition Professional</pre></li><li>Mount the VHDX using diskmgmt.msc. I tried using Mount-DiskImage, but kept running into the following error: <em>"Mount-DiskImage : One or more parameter values passed to the method were invalid."</em> My drive was mounted as F:</li><li>Run the following command to add your new VHD to the boot menu:<pre>bcdboot F:\Windows</pre></li><li>Reboot and select the new O/S in the boot menu.</li></ol>
