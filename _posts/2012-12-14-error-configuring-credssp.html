---
layout: post
title: Error configuring CredSSP
---

I was trying to configure CredSSP from a Windows 8 machine to Windows Server 2008 R2, but ran into the issue below:  <br /><pre>C:\Windows\system32&gt; Enable-WSManCredSSP -Role Client -DelegateComputer remotepc<br /><br />CredSSP Authentication Configuration for WS-Management<br />CredSSP authentication allows the user credentials on this computer to be sent to a remote computer. If you use CredSSP<br /> authentication for a connection to a malicious or compromised computer, that computer will have access to your user<br />name and password. For more information, see the Enable-WSManCredSSP Help topic.<br />Do you want to enable CredSSP authentication?<br />[Y] Yes  [N] No  [S] Suspend  [?] Help (default is "Y"):<br />Enable-WSManCredSSP : <f:wsmanfault code="2150858770" machine="ecargoBartDev.ecargo.net" xmlns:f="http://schemas.microsoft.com/wbem/wsman/1/wsmanfault"><f:message>The client cannot connect to the destination specified in the request.<br />Verify that the service on the destination is running and is accepting requests. Consult the logs and documentation<br />for the WS-Management service running on the destination, most commonly IIS or WinRM. If the destination is the WinRM<br />service, run the following command on the destination to analyze and configure the WinRM service: "winrm quickconfig".<br /></f:message></f:wsmanfault><br />At line:1 char:1<br />+ Enable-WSManCredSSP -Role Client -DelegateComputer COMPUTER<br />+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />    + CategoryInfo          : InvalidOperation: (System.String[]:String[]) [Enable-WSManCredSSP], InvalidOperationExce<br />   ption<br />    + FullyQualifiedErrorId : WsManError,Microsoft.WSMan.Management.EnableWSManCredSSPCommand<br /></pre>I was baffled for a while, since WinRM was correctly configured on the remote PC. However, <a href="http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx">procmon</a> showed that the local command was trying to connect to port 47001 <i>on my local machine</i>, which is the local WinRM service. After starting my local WinRM service, everything worked correctly.
