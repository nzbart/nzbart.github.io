---
layout: post
title: Getting more detail from Azure PowerShell Cmdlet 400 errors
---

Some of the Azure PowerShell Cmdlets return less than useful errors:  <pre class="brush:text"><br />New-AzureDeployment : The remote server returned an unexpected response: (400) Bad Request.<br />At line:1 char:5<br />+     New-AzureDeployment -Slot $slot -Package "$root\NewSite.Azure\bin\Release\ap ...<br />+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />    + CategoryInfo          : CloseError: (:) [New-AzureDeployment], ProtocolException<br />    + FullyQualifiedErrorId : Microsoft.WindowsAzure.Management.ServiceManagement.HostedServices.NewAzureDeploymentCommand<br /></pre> The way to get more detailed information is on <a href="http://blogs.msdn.com/b/benjguin/archive/2012/07/03/windows-azure-powershell-the-remote-server-returned-an-unexpected-response-400-bad-request.aspx">this blog</a>:  <pre class="brush:ps"><br />(New-Object System.IO.StreamReader($Error[0].Exception.InnerException.Response.GetResponseStream())).ReadToEnd()<br /></pre> I have simply formatted this into a useful PowerShell oneliner. Note that this command can only be run once.  The problem in my case was that I had changed my storage account to camel case, but it must be all lower case.  <pre class="brush:xml"><br />&lt;Error xmlns="http://schemas.microsoft.com/windowsazure" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><br />  &lt;Code>BadRequest&lt;/Code><br />  &lt;Message>The name is not a valid storage account name. Storage account names must be between 3 and 24 characters in length and use numbers and lower-case letters only.&lt;/Message><br />&lt;/Error><br /></pre>
